<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:task="http://www.springframework.org/schema/task"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context.xsd
            http://www.springframework.org/schema/task
            http://www.springframework.org/schema/task/spring-task.xsd
            http://www.springframework.org/schema/tx
            http://www.springframework.org/schema/tx/spring-tx.xsd">

    <context:component-scan base-package="org.code_revue.knavery.service"/>

    <!-- DNS Server Config -->

    <bean id="dnsServer" class="org.code_revue.dns.server.DnsServer">
        <property name="connectors">
            <list>
                <ref bean="dnsConnector"/>
            </list>
        </property>
        <property name="engine" ref="dnsEngine"/>
        <property name="executor" ref="executor"/>
    </bean>

    <bean id="dnsConnector" class="org.code_revue.dns.server.connector.DatagramConnector">
        <property name="port" value="1053"/>
    </bean>

    <bean id="dnsEngine" class="org.code_revue.dns.server.engine.StandardEngine">
        <constructor-arg value="208.67.222.222"/>
    </bean>

    <!-- DHCP Server Config -->

    <bean id="dhcpServer" class="org.code_revue.dhcp.server.DhcpServer">
        <property name="engine" ref="dhcpEngine"/>
        <property name="port" value="1067"/>
        <property name="executor" ref="executor"/>
    </bean>

    <bean id="dhcpEngine" class="org.code_revue.dhcp.server.StandardEngine"/>

    <!-- Hibernate/JPA/Sqlite Stuff -->

    <bean id="dataSource" class="org.sqlite.SQLiteDataSource">
        <property name="url" value="jdbc:sqlite::resource:knavery.db"/>
    </bean>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <property name="configLocation" value="classpath:hibernate.cfg.xml"/>
        <property name="packagesToScan" value="org.code_revue.knavery.domain"/>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <tx:annotation-driven/>

    <task:annotation-driven executor="executor"/>
    <task:executor id="executor" pool-size="5"/>

</beans>